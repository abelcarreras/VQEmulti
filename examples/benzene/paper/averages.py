import numpy as np


energies = [
[-227.8851247471353, -227.89070852306193, -227.89540153399997, -227.90494004210638, -227.87685398406936, -227.8717701425702],
[-227.8815310491725, -227.8992422955875, -227.89581304649835, -227.90254096575464, -227.88898659560653, -227.88906913308801, -227.8640082327491],
[-227.87913022251976, -227.8929993019635, -227.8968109151535, -227.89065327541843, -227.8934998210079, -227.88537769465023],
[-227.88116292866926, -227.8903877977453, -227.9002409158573, -227.88013280144855, -227.88769208019056, -227.88822654095623, -227.8815035155536],
[-227.8838033904179, -227.89188263863716, -227.90084816753912, -227.90497560900192, -227.89645172680332, -227.89576751038965],
[-227.88075745734452, -227.89482027503942, -227.90741521075563, -227.88921437917122, -227.8925863217331, -227.88064965784542],
[-227.88857717752845, -227.8924286954158, -227.90288919963263, -227.89757168099732, -227.8869539708954, -227.88488415914736],
[-227.8871216164617, -227.89234348555414, -227.88632203474003, -227.8957459686364, -227.9010531764686, -227.89817512939376],
[-227.8850298587874, -227.89090628220396, -227.89833522338432, -227.88753243399177, -227.88363398753143, -227.88968659187628, -227.86442576765594],
[-227.88812292607992, -227.8889810928873, -227.9045888670042, -227.9036534022337, -227.88965478256236, -227.8878669131571],
[-227.88683674376355, -227.8900921722178, -227.89377765867917, -227.89646238900716, -227.88825273845416, -227.8798336274779],
[-227.88250827462028, -227.89145226593794, -227.90276447503965, -227.90220150774016, -227.8794329350596, -227.8760439935792],
[-227.8833487622208, -227.89082408992198, -227.90832927621105, -227.89944299888083, -227.87815180902476, -227.8916865604714, -227.86007670944485],
[-227.88712363296972, -227.8804700127829, -227.89192532518538, -227.90006364740074, -227.88661350760466, -227.89111990993442, -227.87034893889154],
[-227.88719012499203, -227.88606120322117, -227.90527090353783, -227.89812432317513, -227.88461938672435, -227.88216148661274],
[-227.89014910486637, -227.8867505472545, -227.8966174558019, -227.89348775502245, -227.89040467836466, -227.89439826952525, -227.88596768792652],
[-227.88351692549088, -227.88830206102344, -227.9072547262187, -227.90175192554153, -227.90208051847992, -227.90120609816375],
[-227.87802957444634, -227.89643601978625, -227.89775018979986, -227.89653394377467, -227.8966028971674, -227.90988700861132, -227.8916053332023],
[-227.88637757986402, -227.89421864934047, -227.89529498928957, -227.90101304189588, -227.89180763146365, -227.89120263774524],
[-227.88700670900758, -227.8926422164881, -227.90425953000718, -227.8885363416828, -227.8764545087939, -227.86639234131283],
[-227.88803361573525, -227.89004097258984, -227.90828558604593, -227.8851791415638, -227.87786441012116, -227.88190638254437, -227.90549252221135, -227.86600059093055],
[-227.8845905731634, -227.89360389002564, -227.9034785320841, -227.89746116976752, -227.88263493377013, -227.87909876399243],
[-227.89041845309296, -227.88858079270668, -227.90702603403557, -227.88946351568015, -227.87745645410467, -227.87777929275737, -227.87468163775873],
[-227.8908728018155, -227.89084332285552, -227.90219296049975, -227.89294848580343, -227.8969981730454, -227.89058546098818],
[-227.8892588376947, -227.89195994078005, -227.89831752241855, -227.90631746563065, -227.89557950869857, -227.88724170159645],
[-227.88169564283874, -227.89751765827225, -227.90791605412304, -227.88812647346953, -227.8790126633374, -227.88439437729426, -227.88689144672398, -227.87469519558726],
[-227.886352851745, -227.88992101740715, -227.90633343867654, -227.89502511003164, -227.8864048904776, -227.88113389653608],
[-227.88078599977732, -227.8909529870789, -227.90063182445343, -227.89207647333527, -227.89232421126655, -227.89141610978064],
[-227.87855015961506, -227.89708088079274, -227.9049207987082, -227.8943638595934, -227.8994352989872, -227.89745018293823],
[-227.88799172597547, -227.88924237788802, -227.8999121830891, -227.8883211007083, -227.8940707329691, -227.8900249000227],
]

evaluations = [
[1, 16, 20, 24, 28, 34, 40],
[1, 13, 20, 27, 25, 30, 31, 42],
[1, 15, 21, 23, 36, 31],
[1, 16, 17, 23, 31, 36, 39, 36],
[1, 17, 14, 29, 29, 33],
[1, 15, 17, 23, 38, 26],
[1, 15, 21, 25, 27, 31, 36],
[1, 13, 23, 23, 25, 33],
[1, 12, 23, 29, 33, 37, 32, 40, 39],
[1, 15, 16, 27, 29, 30, 37, 34],
[1, 15, 19, 27, 33, 34, 39],
[1, 13, 20, 24, 30, 27],
[1, 15, 24, 24, 26, 29, 31],
[1, 14, 22, 25, 29, 32, 36],
[1, 14, 16, 29, 27, 38],
[1, 15, 19, 22, 35, 35, 34, 41],
[1, 14, 22, 21, 34, 26, 31],
[1, 13, 14, 22, 26, 42, 31, 42],
[1, 14, 18, 26, 28, 32, 40, 39, 39],
[1, 16, 20, 22, 37, 31, 33, 40],
[1, 14, 17, 24, 28, 33, 40, 35],
[1, 17, 20, 27, 29, 32, 37, 40, 45],
[1, 17, 20, 29, 24, 28],
[1, 16, 18, 31, 32, 29, 37, 51],
[1, 17, 25, 22, 41, 41, 32, 47],
[1, 13, 21, 24, 30, 28],
[1, 14, 18, 27, 27, 33, 44, 39],
[1, 15, 19, 26, 25, 34, 39],
[1, 17, 19, 30, 31, 33, 29],
[1, 14, 22, 28, 27, 30, 35],
]


def process_data(data, omit_last=False):
    average_vector = []
    deviation_vector = []
    for j in range(20):
        values = []
        for d in data:
            if omit_last:
                d = d[:-2]

            if len(d) > j:
                values.append(d[j])

        if len(values) == 0:
            break

        average_vector.append(np.average(values))
        deviation_vector.append(np.std(values))

    return average_vector, deviation_vector


# average_vector, deviation_vector = process_data(evaluations, omit_last=True)
average_vector, deviation_vector = process_data(energies, omit_last=False)

print(average_vector)
print(deviation_vector)

import matplotlib.pyplot as plt

for i, j in zip(average_vector, deviation_vector):
    print('{:20.6f} {:20.6f}'.format(i, j))



plt.plot(average_vector)
plt.figure()
plt.plot(deviation_vector)
plt.show()


average_vector, deviation_vector = process_data(energies)


data = []
for vec in energies:
    data.append(min(vec))

sigma = deviation_vector[-3]

import numpy as np
import matplotlib.pyplot as plt
from scipy.stats import norm

def sum_of_gaussians(data, sigma=1.0, num_points=100):
    x_min, x_max = np.min(data) - 3*sigma, np.max(data) + 3*sigma
    x_values = np.linspace(x_min, x_max, num_points)
    y_values = np.zeros_like(x_values)

    for d in data:
        y_values += norm.pdf(x_values, loc=d, scale=sigma)

    return x_values, y_values/100

x_values, y_values = sum_of_gaussians(data, sigma)

print('\nGaussian')
for x, y in zip(x_values, y_values):
    print('{:10.5f} {:10.5f}'.format(x, y))

plt.plot(x_values, y_values)
plt.title("Suma de Gaussianes amb Scipy")
plt.xlabel("X")
plt.ylabel("F(X)")
plt.show()